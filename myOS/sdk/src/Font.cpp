/**
 * @file Font.cpp
 * @brief Font implementation and built-in font data
 *
 * @author Mustafa Alotbah
 * @copyright myOS Project
 */

#include <myOS/Font.h>

namespace myOS {

// Static font instance
Font Font::Poppins("Poppins");

Font::Font(const char* name) : name_(name) {
    // Initialize all glyphs to empty
    for (int i = 0; i < MAX_FONT_CHARS; ++i) {
        glyphs_[i] = {{0}, 0, 0, 0, 0};
    }
}

const Glyph& Font::getGlyph(uint32_t ch) const {
    if (ch >= MAX_FONT_CHARS) {
        return glyphs_[0];
    }
    return glyphs_[ch];
}

void Font::setGlyph(uint32_t ch, const Glyph& glyph) {
    if (ch < MAX_FONT_CHARS) {
        glyphs_[ch] = glyph;
    }
}

void Font::initialize() {
    initializePoppins();
}

void Font::initializePoppins() {
    for (int i = 0; i < 32; i++) {
        Poppins.setGlyph(i, {{0}, 0, 0, 0, 0});
    }

    Poppins.setGlyph(0x20, {{0x00, 0x00, 0x00, 0x00}, 5, 18, 0, 0});  // Space
    Poppins.setGlyph(0x21, {{0x0, 0x3f20, 0x0, 0x0}, 4, 18, 0, 0});   // !
    Poppins.setGlyph(0x22, {{0x0, 0x6000, 0x0, 0x6000}, 4, 18, 0, 0}); // "
    Poppins.setGlyph(0x23, {{0x0, 0x100, 0x900, 0xbe0, 0x3d00, 0x900, 0x9e0, 0x3f00, 0x900, 0x800, 0x0}, 11, 18, 0, 0}); // #
    Poppins.setGlyph(0x24, {{0x0, 0x1c40, 0x2220, 0x7ff0, 0x2220, 0x3320, 0x11c0, 0x0}, 8, 18, 0, 0}); // $
    Poppins.setGlyph(0x25, {{0x0, 0x1800, 0x2420, 0x2460, 0x1980, 0x600, 0x19e0, 0x2120, 0x1e0, 0x0}, 10, 18, 0, 0}); // %
    Poppins.setGlyph(0x26, {{0x0, 0x1c0, 0x1f20, 0x2620, 0x2320, 0x31a0, 0xc0, 0x1e0, 0x120}, 9, 18, 0, 0}); // &
    Poppins.setGlyph(0x27, {{0x0, 0x6000}, 2, 18, 0, 0}); // '
    Poppins.setGlyph(0x28, {{0x0, 0x3fc0, 0xe070, 0x18008, 0x0, 0x0}, 6, 18, 0, 0}); // (
    Poppins.setGlyph(0x29, {{0x0, 0x18008, 0xe070, 0x1fc0, 0x0, 0x0}, 6, 18, 0, 0}); // )
    Poppins.setGlyph(0x2a, {{0x0, 0x1800, 0x2c00, 0x1800, 0x1800, 0x0}, 6, 18, 0, 0}); // *
    Poppins.setGlyph(0x2b, {{0x0, 0x200, 0x200, 0x200, 0xfc0, 0x200, 0x200, 0x200, 0x0}, 9, 18, 0, 0}); // +
    Poppins.setGlyph(0x2c, {{0x60, 0x0, 0x0}, 3, 18, 0, 0}); // ,
    Poppins.setGlyph(0x2d, {{0x0, 0x200, 0x200, 0x200, 0x200, 0x0, 0x0}, 7, 18, 0, 0}); // -
    Poppins.setGlyph(0x2e, {{0x0, 0x20, 0x0}, 3, 18, 0, 0}); // .
    Poppins.setGlyph(0x2f, {{0x0, 0x78, 0x7c0, 0x7800, 0x18000, 0x0}, 6, 18, 0, 0}); // /
    Poppins.setGlyph(0x30, {{0x0, 0x1fc0, 0x3060, 0x2020, 0x2020, 0x3060, 0xf80, 0x0}, 8, 18, 0, 0}); // 0
    Poppins.setGlyph(0x31, {{0x0, 0x2000, 0x3fe0, 0x0}, 4, 18, 0, 0}); // 1
    Poppins.setGlyph(0x32, {{0x0, 0x1820, 0x2060, 0x20a0, 0x2320, 0x1e20, 0x0}, 7, 18, 0, 0}); // 2
    Poppins.setGlyph(0x33, {{0x80, 0x1060, 0x2220, 0x2220, 0x2520, 0x1dc0, 0x0, 0x0}, 8, 18, 0, 0}); // 3
    Poppins.setGlyph(0x34, {{0x80, 0x180, 0x680, 0x880, 0x3080, 0x3fe0, 0x80, 0x0}, 8, 18, 0, 0}); // 4
    Poppins.setGlyph(0x35, {{0x0, 0x3e40, 0x2620, 0x2420, 0x2420, 0x2660, 0x3c0, 0x0}, 8, 18, 0, 0}); // 5
    Poppins.setGlyph(0x36, {{0x0, 0xfc0, 0x3260, 0x2420, 0x2420, 0x3660, 0x13c0, 0x0}, 8, 18, 0, 0}); // 6
    Poppins.setGlyph(0x37, {{0x2000, 0x2000, 0x2060, 0x2380, 0x2e00, 0x3000, 0x0}, 7, 18, 0, 0}); // 7
    Poppins.setGlyph(0x38, {{0x0, 0x1dc0, 0x2220, 0x2220, 0x2220, 0x2220, 0x1dc0, 0x0}, 8, 18, 0, 0}); // 8
    Poppins.setGlyph(0x39, {{0x0, 0x1e40, 0x3360, 0x2120, 0x2120, 0x3260, 0x1fc0, 0x0}, 8, 18, 0, 0}); // 9
    Poppins.setGlyph(0x3a, {{0x0, 0x820, 0x0}, 3, 18, 0, 0}); // :
    Poppins.setGlyph(0x3b, {{0x10, 0x860, 0x0, 0x0}, 4, 18, 0, 0}); // ;
    Poppins.setGlyph(0x3c, {{0x0, 0x600, 0xf00, 0x1980, 0x1080, 0x0, 0x0}, 7, 18, 0, 0}); // <
    Poppins.setGlyph(0x3d, {{0x0, 0x900, 0x900, 0x900, 0x900, 0x900, 0x900, 0x0, 0x0}, 9, 18, 0, 0}); // =
    Poppins.setGlyph(0x3e, {{0x0, 0x0, 0x1080, 0x900, 0x600, 0x0, 0x0}, 7, 18, 0, 0}); // >
    Poppins.setGlyph(0x3f, {{0x0, 0x1000, 0x2320, 0x2200, 0x2600, 0x1c00, 0x0}, 7, 18, 0, 0}); // ?
    Poppins.setGlyph(0x40, {{0x0, 0x3e0, 0x610, 0x9c8, 0x1e28, 0x1428, 0x1448, 0x17e0, 0x1020, 0x860, 0x780, 0x0, 0x0}, 13, 18, 0, 0}); // @

    // Uppercase letters
    Poppins.setGlyph('A', {{0x0, 0x38, 0x1E0, 0xE20, 0xE20, 0x3E0, 0x78, 0x8, 0x0}, 9, 18, 0, 0});
    Poppins.setGlyph('B', {{0x0, 0x3fe0, 0x2220, 0x2220, 0x2220, 0x2220, 0x1dc0, 0x0}, 8, 18, 0, 0});
    Poppins.setGlyph('C', {{0x0, 0xf80, 0x1040, 0x2020, 0x2020, 0x2020, 0x2020, 0x1040, 0x880, 0x0}, 10, 18, 0, 0});
    Poppins.setGlyph('D', {{0x0, 0x3fe0, 0x2020, 0x2020, 0x2020, 0x2020, 0x1040, 0xf80, 0x0}, 9, 18, 0, 0});
    Poppins.setGlyph('E', {{0x0, 0x3fe0, 0x2220, 0x2220, 0x2220, 0x0, 0x0}, 7, 18, 0, 0});
    Poppins.setGlyph('F', {{0x0, 0x3fe0, 0x2200, 0x2200, 0x2200, 0x2000, 0x0}, 7, 18, 0, 0});
    Poppins.setGlyph('G', {{0x0, 0xf80, 0x18c0, 0x2020, 0x2020, 0x2220, 0x2220, 0x1240, 0x1bc0, 0x200}, 10, 18, 0, 0});
    Poppins.setGlyph('H', {{0x0, 0x3fe0, 0x200, 0x200, 0x200, 0x200, 0x3fe0, 0x0, 0x0}, 9, 18, 0, 0});
    Poppins.setGlyph('I', {{0x0, 0x3fe0, 0x0}, 3, 18, 0, 0});
    Poppins.setGlyph('J', {{0x0, 0x40, 0x20, 0x20, 0x20, 0x3fc0, 0x0}, 7, 18, 0, 0});
    Poppins.setGlyph('K', {{0x0, 0x3fe0, 0x200, 0xd80, 0x18c0, 0x3060, 0x0, 0x0}, 8, 18, 0, 0});
    Poppins.setGlyph('L', {{0x0, 0x3fe0, 0x20, 0x20, 0x20, 0x0}, 6, 18, 0, 0});
    Poppins.setGlyph('M', {{0x0, 0x3fe0, 0x1c00, 0x300, 0xe0, 0xe0, 0x300, 0x1c00, 0x3fe0, 0x0, 0x0}, 11, 18, 0, 0});
    Poppins.setGlyph('N', {{0x0, 0x3fe0, 0x1800, 0xc00, 0x200, 0x180, 0xc0, 0x3fe0, 0x0}, 9, 18, 0, 0});
    Poppins.setGlyph('O', {{0x0, 0xf80, 0x10c0, 0x2020, 0x2020, 0x2020, 0x2020, 0x1040, 0xf80, 0x0}, 10, 18, 0, 0});
    Poppins.setGlyph('P', {{0x0, 0x3fe0, 0x2200, 0x2200, 0x2200, 0x2200, 0x1c00}, 7, 18, 0, 0});
    Poppins.setGlyph('Q', {{0x0, 0xf80, 0x10c0, 0x2020, 0x2020, 0x2020, 0x2020, 0x1050, 0xf88, 0x0}, 10, 18, 0, 0});
    Poppins.setGlyph('R', {{0x0, 0x3fe0, 0x2200, 0x2200, 0x2380, 0x22c0, 0x1c20, 0x0}, 8, 18, 0, 0});
    Poppins.setGlyph('S', {{0x0, 0x1c40, 0x2660, 0x2220, 0x2220, 0x3320, 0x11c0, 0x0}, 8, 18, 0, 0});
    Poppins.setGlyph('T', {{0x0, 0x2000, 0x2000, 0x3fe0, 0x2000, 0x2000, 0x0}, 7, 18, 0, 0});
    Poppins.setGlyph('U', {{0x0, 0x3fc0, 0x60, 0x20, 0x20, 0x60, 0x3fc0, 0x0, 0x0}, 9, 18, 0, 0});
    Poppins.setGlyph('V', {{0x2000, 0x3c00, 0x700, 0xe0, 0xe0, 0x780, 0x1c00, 0x2000, 0x0}, 9, 18, 0, 0});
    Poppins.setGlyph('W', {{0x2000, 0x3e00, 0x3e0, 0x60, 0x780, 0x3800, 0x3c00, 0x3c0, 0x60, 0x780, 0x3c00, 0x0}, 12, 18, 0, 0});
    Poppins.setGlyph('X', {{0x0, 0x3060, 0x18c0, 0x700, 0xd80, 0x3860, 0x2020, 0x0}, 8, 18, 0, 0});
    Poppins.setGlyph('Y', {{0x0, 0x3800, 0xe00, 0x1e0, 0xe00, 0x3800, 0x0, 0x0}, 8, 18, 0, 0});
    Poppins.setGlyph('Z', {{0x0, 0x2060, 0x20e0, 0x2320, 0x2c20, 0x3820, 0x2020}, 7, 18, 0, 0});
    Poppins.setGlyph('[', {{0x0, 0x0, 0x1fff8, 0x10008, 0x0, 0x0}, 6, 18, 0, 0});
    Poppins.setGlyph('\\', {{0x0, 0x0, 0x1c000, 0x3c00, 0x3c0, 0x38, 0x0, 0x0}, 8, 18, 0, 0});
    Poppins.setGlyph(']', {{0x0, 0x10008, 0x1fff8, 0x0, 0x0, 0x0}, 6, 18, 0, 0});
    Poppins.setGlyph('^', {{0x0, 0x180, 0xe00, 0x3800, 0x1c00, 0x700, 0x80, 0x0}, 8, 18, 0, 0});
    Poppins.setGlyph('_', {{0x0, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x0, 0x0}, 9, 18, 0, 0});
    Poppins.setGlyph('`', {{0x0, 0x4000, 0x2000, 0x1000}, 4, 18, 0, 0});

    // Lowercase letters
    Poppins.setGlyph('a', {{0x0, 0x380, 0x440, 0x820, 0x820, 0x820, 0x440, 0xfe0, 0x0}, 9, 18, 0, 0});
    Poppins.setGlyph('b', {{0x0, 0x3fe0, 0x440, 0x820, 0x820, 0x820, 0x440, 0x380, 0x0}, 9, 18, 0, 0});
    Poppins.setGlyph('c', {{0x0, 0x7c0, 0xc60, 0x820, 0x820, 0xc60, 0x440, 0x0}, 8, 18, 0, 0});
    Poppins.setGlyph('d', {{0x0, 0x380, 0x440, 0x820, 0x820, 0x820, 0x440, 0x3fe0, 0x0}, 9, 18, 0, 0});
    Poppins.setGlyph('e', {{0x0, 0x7c0, 0xd60, 0x920, 0x920, 0xd60, 0x740, 0x0}, 8, 18, 0, 0});
    Poppins.setGlyph('f', {{0x800, 0x3fe0, 0x2800, 0x0}, 4, 18, 0, 0});
    Poppins.setGlyph('g', {{0x0, 0x380, 0x448, 0x824, 0x824, 0x824, 0x44c, 0xff8, 0x0}, 9, 18, 0, 0});
    Poppins.setGlyph('h', {{0x0, 0x3fe0, 0x400, 0x800, 0x800, 0xc00, 0x7e0, 0x0}, 8, 18, 0, 0});
    Poppins.setGlyph('i', {{0x0, 0x2fe0, 0x0}, 3, 18, 0, 0});
    Poppins.setGlyph('j', {{0x2ffc, 0x0, 0x0}, 3, 18, 0, 0});
    Poppins.setGlyph('k', {{0x0, 0x3fe0, 0x380, 0x6c0, 0xc60, 0x820, 0x0}, 7, 18, 0, 0});
    Poppins.setGlyph('l', {{0x0, 0x3fe0, 0x0}, 3, 18, 0, 0});
    Poppins.setGlyph('m', {{0x0, 0xfe0, 0x400, 0x800, 0x800, 0xc00, 0x7e0, 0x400, 0x800, 0x800, 0xc00, 0x7e0, 0x0}, 13, 18, 0, 0});
    Poppins.setGlyph('n', {{0x0, 0xfe0, 0x400, 0x800, 0x800, 0xc00, 0x7e0, 0x0}, 8, 18, 0, 0});
    Poppins.setGlyph('o', {{0x0, 0x380, 0x440, 0x820, 0x820, 0x820, 0x440, 0x380}, 8, 18, 0, 0});
    Poppins.setGlyph('p', {{0x0, 0xffc, 0x440, 0x820, 0x820, 0x820, 0x440, 0x380, 0x0}, 9, 18, 0, 0});
    Poppins.setGlyph('q', {{0x0, 0x380, 0x440, 0x820, 0x820, 0x820, 0x440, 0xffc, 0x0}, 9, 18, 0, 0});
    Poppins.setGlyph('r', {{0x0, 0xfe0, 0xc00, 0x800, 0x0}, 5, 18, 0, 0});
    Poppins.setGlyph('s', {{0x0, 0x640, 0x920, 0x920, 0x920, 0x4c0, 0x0}, 7, 18, 0, 0});
    Poppins.setGlyph('t', {{0x800, 0x3fe0, 0x820, 0x820, 0x0}, 5, 18, 0, 0});
    Poppins.setGlyph('u', {{0x0, 0xfc0, 0x60, 0x20, 0x20, 0x40, 0xfe0, 0x0}, 8, 18, 0, 0});
    Poppins.setGlyph('v', {{0x800, 0x700, 0x1c0, 0x60, 0x1c0, 0xe00, 0x0}, 7, 18, 0, 0});
    Poppins.setGlyph('w', {{0x800, 0x780, 0x60, 0x1e0, 0xe00, 0xf00, 0xe0, 0xe0, 0xf00, 0x800}, 10, 18, 0, 0});
    Poppins.setGlyph('x', {{0x820, 0xc60, 0x380, 0x2c0, 0xc60, 0x0}, 6, 18, 0, 0});
    Poppins.setGlyph('y', {{0x800, 0xe00, 0x1dc, 0x70, 0x180, 0xe00, 0x0}, 7, 18, 0, 0});
    Poppins.setGlyph('z', {{0x0, 0x860, 0x8e0, 0xb20, 0xe20, 0x820}, 6, 18, 0, 0});
    Poppins.setGlyph('{', {{0x0, 0x600, 0x1fff8, 0x10008, 0x0, 0x0}, 6, 18, 0, 0});
    Poppins.setGlyph('|', {{0x0, 0xfff0, 0x0, 0x0}, 4, 18, 0, 0});
    Poppins.setGlyph('}', {{0x0, 0x10008, 0x1fff8, 0x600, 0x0, 0x0}, 6, 18, 0, 0});
    Poppins.setGlyph('~', {{0x100, 0x200, 0x200, 0x100, 0x100, 0x200, 0x0}, 7, 18, 0, 0});
}

} // namespace myOS

